### üìÑ Cadastro de eBooks - Parte 1

#### üß© **Descri√ß√£o da Funcionalidade**

Essa atividade consiste na implementa√ß√£o do **CRUD (Create, Read, Update, Delete)** para eBooks personalizados dentro da aplica√ß√£o. O objetivo inicial √© permitir que usu√°rios autenticados e com assinatura v√°lida possam **criar e gerenciar seus pr√≥prios eBooks**, dando-lhes um nome personalizado. Cada eBook ser√° salvo automaticamente sempre que uma altera√ß√£o ocorrer (como renomear ou editar), sem necessidade de bot√£o de salvar. Al√©m disso, os eBooks podem ser **clonados ou exclu√≠dos** de forma pr√°tica.

Neste primeiro momento, o foco est√° exclusivamente na estrutura de **cadastro e gerenciamento dos eBooks**, sem ainda incluir a l√≥gica de adicionar ou remover atividades dentro dos mesmos ‚Äî essa parte ser√° desenvolvida em uma etapa posterior.
#### ‚úÖ **Requisitos Funcionais**

#### üîê Autentica√ß√£o e Acesso

- O usu√°rio deve estar **logado** para acessar qualquer funcionalidade de eBooks.
- A tela de eBooks pode ser acessada mesmo por usu√°rios **sem assinatura v√°lida**.
- Caso o usu√°rio **n√£o possua uma assinatura ativa**, a interface deve:
    - **Ocultar ou desabilitar** todas as a√ß√µes de cria√ß√£o, edi√ß√£o, exclus√£o ou clonagem de eBooks.
    - Exibir uma **mensagem clara** informando que a funcionalidade est√° dispon√≠vel apenas para usu√°rios com assinatura ativa.
    - Apresentar um **bot√£o de CTA (Call to Action)** com o texto como por exemplo ‚ÄúAtivar Assinatura para Criar eBooks‚Äù, apontando temporariamente para `https://google.com` (link que ser√° atualizado futuramente).

#### üìò Cadastro (Create)

- Usu√°rios logados e com assinatura v√°lida podem **criar um novo eBook**, informando um nome personalizado.
- O nome √© **obrigat√≥rio** e deve ser √∫nico por usu√°rio.
    
#### üìñ Consulta (Read)

- O usu√°rio pode **visualizar a lista de eBooks criados por ele**, com informa√ß√µes como nome, data de cria√ß√£o e quantidade de atividades.
- A listagem deve estar ordenada de forma alfab√©tica ou por data, com layout responsivo.
- No componente (widget) de eBook deve ter os bot√µes se selecionar, clonar e excluir.

#### ‚úèÔ∏è Atualiza√ß√£o (Update)

- O nome do eBook pode ser **editado diretamente**.
- O sistema deve **salvar automaticamente** qualquer altera√ß√£o feita.

#### ‚ùå Exclus√£o (Delete)

- O usu√°rio pode **excluir um eBook existente**, com confirma√ß√£o pr√©via obrigat√≥ria.

#### üìë Clonagem

- O usu√°rio pode **clonar qualquer eBook de sua autoria**.
- Ao acionar a op√ß√£o de clonagem, o sistema deve:
    - Exibir um **modal de confirma√ß√£o** com um campo de texto preenchido automaticamente com o nome do eBook atual seguido do sufixo `" - C√≥pia"`.
    - Permitir que o usu√°rio **edite o nome** antes de confirmar a clonagem.
- Ap√≥s a confirma√ß√£o, ser√° criada uma **nova inst√¢ncia independente do eBook**, com o nome definido no modal.
- O novo eBook clonado deve ser imediatamente adicionado √† lista e tratado como um item distinto.
#### üìå Indica√ß√£o Visual do eBook Selecionado no Cabe√ßalho

- O cabe√ßalho da aplica√ß√£o deve exibir **visualmente o eBook atualmente selecionado pelo usu√°rio**.
- Esse componente visual deve conter:
    - O **nome do eBook** selecionado.
    - Um **√≠cone circular** com a **quantidade de atividades** atualmente adicionadas ao eBook.
- Ao **clicar no componente**, o usu√°rio deve ser **redirecionado para a tela de detalhes** do eBook selecionado.
- Esse componente s√≥ deve ser exibido se um eBook estiver atualmente selecionado.
- Remover o nome da aplica√ß√£o no cabe√ßalho para melhorar a responsividade 
    
#### üìÅ **Pastas e Arquivos Permitidos**

```
client/src/components/ebooks (pasta para os componentes)
client/src/pages/EBooksPage.tsx (alterar)
client/src/pages/DetalheEBookPage.tsx (criar)
client/src/contexts (criar um contexto para ebooks)
client/src/hooks (criar hooks se necess√°rio)
```

Observa√ß√£o: as informa√ß√µes de ebooks devem ser acess√≠veis e compartilhadas em todas as telas da aplica√ß√£o

#### üîí **Restri√ß√µes de Seguran√ßa e Boas Pr√°ticas**

- N√£o modifique arquivos fora dos listados acima.
- N√£o crie nem modifique tabelas de banco de dados sem solicita√ß√£o expl√≠cita.
- N√£o apague ou sobrescreva dados sem instru√ß√£o clara.
- Toda vari√°vel sens√≠vel (como chaves de API, tokens ou URLs protegidas) deve ser armazenada em arquivos `.env` ou equivalente.
- Sempre perguntar antes de instalar bibliotecas externas ou adicionar depend√™ncias.
- Todas as opera√ß√µes que envolvam escrita ou leitura em banco de dados devem ser explicitamente solicitadas no prompt principal.
- Evitar comandos destrutivos ou irrevers√≠veis, como `DELETE`, exceto sob instru√ß√£o expl√≠cita.
- Assegure-se de n√£o expor dados sens√≠veis no frontend.

#### üìå **Orienta√ß√µes de Desenvolvimento Padr√£o**

- Usar nomes claros e sem√¢nticos para vari√°veis e fun√ß√µes.
- Dividir responsabilidades entre componentes (ex: l√≥gica de autentica√ß√£o separada da UI).
- Comentar trechos de l√≥gica complexa.
- Priorizar c√≥digo limpo, reutiliz√°vel e organizado.
- Validar entradas do usu√°rio sempre que aplic√°vel.
- Preferir fun√ß√µes puras e evitar efeitos colaterais n√£o controlados.
- Priorizar acessibilidade e compatibilidade responsiva na interface.

#### Informa√ß√µes sobre o Banco de dados

Os dados de eBooks s√£o armazenados na cole√ß√£o `/usuarios/{userId}/ebooks/{ebookId}`

- Regras atuais do Firestore

```
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    match /usuarios/{userId} {      
      allow read, write: if request.auth != null && request.auth.uid == userId;
    
    	match /ebooks/{ebookId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
    }

		match /assinaturas/{email} {
      allow read: if request.auth != null && request.auth.token.email == email;
    }

    match /{document=**} {
      allow read, write: if false;
    }
  }
```


#### Modelo para eBook

```json
{
	"id": "3956fdee-4ef7-403a-bd35-d1d155dca974",
	"nome": "Atividades de F√©rias do Jo√£o",
	"data": "2025-12-23T22:30:00",
	"atividades": [
		"f0eed885-7112-4b4d-b124-054821a54e44"
	]
}
```